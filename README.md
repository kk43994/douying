# 天雨学长AI编导

面向短视频增长的本地工具：抖音单视频/账号分析 + 视频口播文案提取 + 脚本生成。

## 功能概览
- 单视频：解析链接元数据、提取视频口播文案（无字幕时点「提取视频文案」）、基于口播与数据做深度拆解（只输出中文、Markdown 排版）
- 账号：账号基础信息分析 + 账号/视频工具箱（前端占位，可导出/复制报告、Top10 样本展示）
- 生成：脚本生成、模板、人物设定与产品库
- 设置：分析模型配置、文案提取 API 配置、语音识别配置、流式输出开关

## 环境要求
- Windows 10/11（优先支持）；Mac/Linux 理论可跑（未做大量验证）
- Node.js 18+（建议 20+）
- 首次启动需要联网下载依赖；使用过程中需要联网请求抖音公开页、以及调用大模型/语音识别接口

## 快速开始（推荐：Windows 一键启动）
1) 双击 `启动平台.bat`
2) 首次启动会自动 `npm install`，并在缺少 `dist/` 时自动 `npm run build`
3) 自动打开：`http://127.0.0.1:3000/`

启动参数（可选）：
- `启动平台.bat --dev`：开发模式（热更新）
- `启动平台.bat --port 3001`：换端口
- `启动平台.bat --no-open`：不自动打开浏览器
- `启动平台.bat --build`：强制重新构建

## 开发模式启动（命令行）
1) 安装依赖：`npm install`
2) 启动：`npm run dev`
3) 打开：`http://127.0.0.1:3000/`

## 一键启动/关闭（Windows）
- 启动：双击 `启动平台.bat`
- 关闭：双击 `关闭平台.bat`
- 重启：双击 `重启平台.bat`
- 常见问题：见 `使用说明.md:1`

## 一键启动/关闭（macOS）
- 启动：双击 `启动平台.command`
- 关闭：双击 `关闭平台.command`
- 重启：双击 `重启平台.command`
- 若提示“没有权限/无法打开”：先在项目目录执行 `chmod +x 启动平台.command 关闭平台.command 重启平台.command`

## 配置说明
所有配置都可以在应用内「设置」完成；也支持用环境变量做默认值（可选）。

### 1) 分析模型配置（用于单视频/账号深度分析）
- 入口：页面右上角/侧栏 →「设置」
- 支持两类 Provider：
  - `yunwu`：OpenAI 兼容接口（默认 `https://yunwu.ai/v1`）
  - `volcano`：火山方舟（Ark，默认 `https://ark.cn-beijing.volces.com/api/v3`）
- 推荐做法：优先在 UI 里填；如需环境变量，复制 `.env.example` 为 `.env.local` 后填写 `YUNWU_*`。

### 2) 语音识别配置（用于“提取视频文案/口播”）
当视频本身没有可用字幕时，会走“下载视频 → 本地抽音频 → 语音转文字”的链路。

- 默认：豆包语音（更稳定，不依赖模型能否联网打开抖音链接）
  - 需要：`AppID（豆包语音）` + `Access Token（豆包语音）`
  - 注意：这里的 Access Token 是豆包语音控制台的服务认证信息，不是 IAM 的 AccessKeyID/SecretAccessKey。
- 备选：阿里百炼 Paraformer（项目保留但不默认启用）
  - 需要：`阿里百炼 API Key（Paraformer）`

### 3) 文案提取 API 配置（独立于“分析”）
这是一个“备用方案”：尝试用豆包大模型**直接从链接**提取口播文案（可能需要开通联网插件）。

- 入口：设置页 →「文案提取 API 配置」
- 默认按火山引擎 Ark 配置（与“分析”解耦；当主 Provider=volcano 且此处为空时可复用主配置）

## 打包发布（发给别人）
双击 `打包发布.bat`，会在 `release/` 下生成 zip 压缩包。

对方使用方式：
- 解压后双击 `启动平台.bat`
- 对方电脑仍需要安装 Node.js（本项目不是“免安装单文件版”）

## 使用指引（核心流程）
### 单视频分析
1) 粘贴抖音视频链接或分享文本（会自动提取链接）
2) 可先点「测试链接」确认能否解析视频/播放地址
3) 点「开始分析」生成报告
4) 如果页面提示“暂无字幕/口播文案未提供”，点「提取视频文案」
   - 进度会显示：下载视频 → 提取音频 → 提交识别 → 完成
5) 提取完成后可进行更稳定的深度拆解（系统会把口播文案作为事实输入）

### 账号分析
1) 粘贴抖音主页链接或分享文本
2) 点「开始分析」生成账号报告
3) 页面会展示账号可视化信息与 Top10 样本（封面、点赞/评论/转发等）

### 取消长任务
分析/转写/复刻/选题等进行中，页面右上角会出现「取消」按钮，可随时中止本次请求。

### 流式输出开关
设置页可开启/关闭「流式输出（边生成边显示）」：
- 开启：反馈更及时
- 关闭：等待完整结果后一次性展示（网络不稳时更清爽）

## 常见问题
### 1) 启动失败 / 页面打不开
- 看日志：`platform.err.log`
- 端口占用：`启动平台.bat --port 3001`

### 2) 提取视频文案失败（403 / 权限不足 / requested resource not granted）
- 多数是豆包语音资源权限/Token 不对：请确认已开通对应服务、并使用“语音服务的 Access Token”

### 3) 无法获取视频播放地址 / 链接权限受限
- 可能是链接类型不对、视频受限、或抖音风控导致；建议换一个分享链接重试
- 也可选择“在缺少口播文案的情况下推断继续分析”（可靠性会下降）

## 安全提示
- 不要把 `.env.local` 提交到 GitHub（本项目已在 `.gitignore` 忽略）。
- 不要在截图/录屏/日志里泄露你的 API Key/Token。
